<?xml version="1.0" encoding="utf-8"?>
<DataSchemaModel FileFormatVersion="1.2" SchemaVersion="2.4" DspName="Microsoft.Data.Tools.Schema.Sql.Sql120DatabaseSchemaProvider" CollationLcid="1033" CollationCaseSensitive="False" xmlns="http://schemas.microsoft.com/sqlserver/dac/Serialization/2012/02">
	<Header>
		<CustomData Category="AnsiNulls">
			<Metadata Name="AnsiNulls" Value="True" />
		</CustomData>
		<CustomData Category="QuotedIdentifier">
			<Metadata Name="QuotedIdentifier" Value="True" />
		</CustomData>
		<CustomData Category="CompatibilityMode">
			<Metadata Name="CompatibilityMode" Value="120" />
		</CustomData>
		<CustomData Category="Reference" Type="Assembly">
			<Metadata Name="LogicalName" Value="QuizDB.dll" />
			<Metadata Name="FileName" Value="E:\МОИ ДОКУМЕНТЫ\EPAM\FINALTASK\QUIZDB\OBJ\DEBUG\QUIZDB.DLL" />
			<Metadata Name="AssemblyName" Value="QuizDB" />
			<Metadata Name="PermissionSet" Value="SAFE" />
			<Metadata Name="Owner" Value="" />
			<Metadata Name="GenerateSqlClrDdl" Value="True" />
			<Metadata Name="IsVisible" Value="True" />
			<Metadata Name="IsModelAware" Value="True" />
			<Metadata Name="SkipCreationIfEmpty" Value="True" />
			<Metadata Name="AssemblySymbolsName" Value="E:\Мои документы\EPAM\FinalTask\QuizDB\obj\Debug\QuizDB.pdb" />
		</CustomData>
		<CustomData Category="SqlCmdVariables" Type="SqlCmdVariable" />
	</Header>
	<Model>
		<Element Type="SqlDatabaseOptions">
			<Property Name="Collation" Value="SQL_Latin1_General_CP1_CI_AS" />
			<Property Name="IsAnsiNullDefaultOn" Value="True" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="IsAnsiWarningsOn" Value="True" />
			<Property Name="IsArithAbortOn" Value="True" />
			<Property Name="IsConcatNullYieldsNullOn" Value="True" />
			<Property Name="IsTornPageProtectionOn" Value="False" />
			<Property Name="IsFullTextEnabled" Value="True" />
			<Property Name="PageVerifyMode" Value="3" />
			<Property Name="DefaultLanguage" Value="" />
			<Property Name="DefaultFullTextLanguage" Value="" />
			<Relationship Name="DefaultFilegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlCheckConstraint" Name="[dbo].[CK1_M_QUIZ_RESULTS]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[[COMPLETED_RATE] >=0 AND [COMPLETED_RATE] <= 1]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_RATE]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="3" />
		</Element>
		<Element Type="SqlCheckConstraint" Name="[dbo].[CK1_M_QUIZES]">
			<Property Name="CheckExpressionScript">
				<Value><![CDATA[[SUCCESS_RATE] >0 AND [SUCCESS_RATE] <= 1]]></Value>
			</Property>
			<Relationship Name="CheckExpressionDependencies">
				<Entry>
					<References Name="[dbo].[M_QUIZES].[SUCCESS_RATE]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="4" />
		</Element>
		<Element Type="SqlScalarFunction" Name="[DBO].[F_PRINT_DATEDIFF]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[DBO].[F_PRINT_DATEDIFF].[@D1]" />
				</Entry>
				<Entry>
					<References Name="[DBO].[F_PRINT_DATEDIFF].[@D2]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN
	DECLARE @seconds int = DATEDIFF(second,@D1,@d2)
	DECLARE @hours int, @minutes int , @sec int
	SELECT @hours = @seconds/3600 , 
	 @minutes = (@seconds - ( @seconds/3600) * 3600) / 60 ,
	 @sec = (@seconds - ((@seconds/3600) * 3600 + ((@seconds - ( @seconds/3600) * 3600)/60)* 60))

	RETURN RIGHT('00'+CONVERT(varchar(2), @hours),2)+ ':'+
		RIGHT('00'+ CONVERT(varchar(2), @minutes),2)+':'+
		RIGHT('00' + CONVERT(varchar(2), @sec),2)
END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="Length" Value="556" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="CREATE FUNCTION [DBO].[F_PRINT_DATEDIFF]&#xD;&#xA;(&#xD;&#xA;&#x9;@D1 datetime,&#xD;&#xA;&#x9;@D2 datetime&#xD;&#xA;)&#xD;&#xA;RETURNS nvarchar(8)&#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[DBO].[F_PRINT_DATEDIFF].[@D1]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[DBO].[F_PRINT_DATEDIFF].[@D2]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Length" Value="8" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[nvarchar]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK1_M_QUESTIONS]">
			<Property Name="OnDeleteAction" Value="1" />
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="5" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK1_M_QUIZ_ANSWERS]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="6" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK1_M_QUIZ_RESULTS]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="7" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK1_M_QUIZES]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[M_QUIZES].[AUTHOR_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="8" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK1_M_VARIANTS]">
			<Property Name="OnDeleteAction" Value="1" />
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[QUESTION_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_VARIANTS]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="9" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK2_M_QUIZ_ANSWERS]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUESTION_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="10" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK2_M_QUIZ_RESULTS]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="11" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK3_M_QUIZ_ANSWERS]">
			<Property Name="OnDeleteAction" Value="1" />
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_RESULT_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="12" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK3_M_QUIZ_RESULTS]">
			<Property Name="OnDeleteAction" Value="1" />
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[ASSIGNED_BY_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="13" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[M_QUESTIONS]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUESTIONS].[QUESTION_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUESTIONS].[QUIZ_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUESTIONS].[INFO]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUESTIONS].[TEXT]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUESTIONS].[CORRECT_OPTION_FLAG]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="14" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="5" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[M_QUIZ_ANSWERS]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_ANSWERS_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_RESULT_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_ANSWERS].[QUESTION_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_ANSWERS].[ANSWER_FLAG]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_ANSWERS].[TIMESTAMP]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="15" />
			<AttachedAnnotation Disambiguator="6" />
			<AttachedAnnotation Disambiguator="10" />
			<AttachedAnnotation Disambiguator="12" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[M_QUIZ_RESULTS]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_STATUS]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_RESULTS].[ASSIGNED_BY_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_RESULTS].[ASSIGNED_DATE]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_RESULTS].[STARTED_DATE]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_RESULTS].[TIME_TAKEN]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_RATE]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[real]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_DATE]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="16" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="7" />
			<AttachedAnnotation Disambiguator="11" />
			<AttachedAnnotation Disambiguator="13" />
			<AttachedAnnotation Disambiguator="3" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[M_QUIZES]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZES].[QUIZ_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZES].[QUIZ_NAME]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZES].[AUTHOR_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZES].[CREATED_DATE]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_QUIZES].[SUCCESS_RATE]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[real]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="17" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="18" />
			<AttachedAnnotation Disambiguator="8" />
			<AttachedAnnotation Disambiguator="4" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[M_ROLES]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_ROLES].[ROLE_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_ROLES].[ROLE_NAME]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_ROLES].[ROLE_FLAG]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_ROLES].[ALLOWED_METHODS]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlTable" Name="[dbo].[M_USERS]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_USERS].[USER_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_USERS].[FIRSTNAME]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_USERS].[LASTNAME]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_USERS].[USERNAME]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_USERS].[HASHEDPASSWORD]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_USERS].[SALT]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_USERS].[ROLESFLAG]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_USERS].[REGISTRATION_DATE]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_USERS].[LAST_LOGON_DATE]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="19" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="20" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[M_VARIANTS]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_VARIANTS].[VARIANT_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_VARIANTS].[QUESTION_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[M_VARIANTS].[TEXT]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="21" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="9" />
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[dbo].[NK1_M_QUIZES]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="18" />
		</Element>
		<Element Type="SqlUniqueConstraint" Name="[dbo].[NK1_M_USERS]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[M_USERS].[USERNAME]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="20" />
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_DELETEQUESTION]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SET @ERROR = 0;
	SET @ERRORTEXT = N'Ok';
	IF NOT EXISTS(SELECT * FROM dbo.M_QUIZES WHERE QUIZ_ID  = @QuizID)
	/* DB consistency error */
		SELECT @ERROR = -1,	@ERRORTEXT = N'No Quiz '+ CAST(@QuizID as nvarchar(10)) + N' in M_QUIZES table';
	ELSE
	BEGIN
		BEGIN TRY
			IF (EXISTS(SELECT * FROM dbo.[M_QUESTIONS] Q WHERE Q.QUESTION_ID = @QuestionID AND Q.QUIZ_ID = @QuizID))
			BEGIN
				DELETE FROM dbo.[M_QUESTIONS] WHERE QUIZ_ID = @QuizID AND QUESTION_ID = @QuestionID
			END
			ELSE
			BEGIN
				SELECT @ERROR = -1, @ERRORTEXT = N'No Question '+ CAST(@QuestionID as nvarchar(10)) + N' in M_QUESTIONS table';
			END
		END TRY
		BEGIN CATCH
			SELECT @ERROR = ERROR_NUMBER(), @ERRORTEXT = ERROR_MESSAGE();
		END CATCH
	END

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[P_DELETEQUESTION].[@ERROR]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_DELETEQUESTION].[@ERRORTEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_DELETEQUESTION].[@QuizID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_DELETEQUESTION].[@QuestionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEQUESTION].[@QuizID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEQUESTION].[@QuestionID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEQUESTION].[@ERROR]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEQUESTION].[@ERRORTEXT]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1128" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_DELETEQUESTION]&#xD;&#xA;@QuizID int , &#xD;&#xA;                                        @QuestionID int , &#xD;&#xA;                                        @ERROR int OUT, &#xD;&#xA;                                        @ERRORTEXT nvarchar(1000) OUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_DELETEQUIZ]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SET @ERROR = 0;
	SET @ERRORTEXT = N'Ok';
	IF NOT EXISTS(SELECT * FROM dbo.M_QUIZES WHERE QUIZ_ID  = @QuizID)
	/* DB consistency error */
		SELECT @ERROR = -1,	@ERRORTEXT = N'No Quiz '+ CAST(@QuizID as nvarchar(10)) + N' in M_QUIZES table';
	ELSE
	BEGIN
		BEGIN TRY
			DELETE FROM dbo.[M_QUIZES] WHERE QUIZ_ID = @QuizID
		END TRY
		BEGIN CATCH
			SELECT @ERROR = ERROR_NUMBER(), @ERRORTEXT = ERROR_MESSAGE();
		END CATCH
	END

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[P_DELETEQUIZ].[@ERROR]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_DELETEQUIZ].[@ERRORTEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_DELETEQUIZ].[@QuizID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEQUIZ].[@QuizID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEQUIZ].[@ERROR]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEQUIZ].[@ERRORTEXT]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="769" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_DELETEQUIZ]&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;@QuizID int , &#xD;&#xA;                                        @ERROR int OUT, &#xD;&#xA;                                        @ERRORTEXT nvarchar(1000) OUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_DELETEUSER]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SET @ERROR = 0;
	SET @ERRORTEXT = N'Delete Ok';
	BEGIN TRY
		IF EXISTS(SELECT * FROM dbo.M_USERS WHERE USER_ID = @USERID)
			DELETE FROM dbo.M_USERS WHERE USER_ID = @USERID
		ELSE
			SELECT @ERROR = -1,	@ERRORTEXT = N'No UserID '+CAST(@USERID as nvarchar(10)) + N' in M_USERS table';
	END TRY
	BEGIN CATCH
		SELECT @ERROR = ERROR_NUMBER(), @ERRORTEXT = ERROR_MESSAGE();
	END CATCH
	RETURN 0
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[P_DELETEUSER].[@ERROR]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_DELETEUSER].[@ERRORTEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_DELETEUSER].[@USERID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEUSER].[@USERID]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[0]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEUSER].[@ERROR]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEUSER].[@ERRORTEXT]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="527" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_DELETEUSER]&#xD;&#xA;&#x9;@USERID int = 0,&#xD;&#xA;&#x9;@ERROR int out,&#xD;&#xA;&#x9;@ERRORTEXT nvarchar(100) out&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_DELETEVARIANT]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SET @ERROR = 0;
	SET @ERRORTEXT = N'Ok';
	IF NOT EXISTS(SELECT * FROM dbo.M_QUIZES WHERE QUIZ_ID  = @QuizID) OR NOT EXISTS(SELECT * FROM dbo.M_QUESTIONS WHERE QUESTION_ID  = @QuestionID)
	/* DB consistency error */
		SELECT @ERROR = -1,	@ERRORTEXT = N'No Quiz/Questiuon '+ CAST(@QuizID as nvarchar(10)) + N' in M_QUIZES/M_QUESTIONS table';
	ELSE
	BEGIN
		BEGIN TRY
			IF (EXISTS(SELECT * FROM dbo.[M_VARIANTS] V WHERE V.QUESTION_ID = @QuestionID AND V.VARIANT_ID = @VariantID))
			BEGIN
				DELETE FROM dbo.[M_VARIANTS] WHERE QUESTION_ID = @QuestionID AND VARIANT_ID = @VariantID
			END
			ELSE
			BEGIN
				SELECT @ERROR = -1, @ERRORTEXT = N'No Variant '+ CAST(@VariantID as nvarchar(10)) + N' in M_VARIANTS table';
			END
		END TRY
		BEGIN CATCH
			SELECT @ERROR = ERROR_NUMBER(), @ERRORTEXT = ERROR_MESSAGE();
		END CATCH
	END

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[P_DELETEVARIANT].[@ERROR]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_DELETEVARIANT].[@ERRORTEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_DELETEVARIANT].[@QuizID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_DELETEVARIANT].[@QuestionID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[VARIANT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_DELETEVARIANT].[@VariantID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[VARIANT_ID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEVARIANT].[@QuizID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEVARIANT].[@QuestionID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEVARIANT].[@VariantID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEVARIANT].[@ERROR]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_DELETEVARIANT].[@ERRORTEXT]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1301" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_DELETEVARIANT]&#xD;&#xA;                                        @QuizID int , &#xD;&#xA;                                        @QuestionID int , &#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;@VariantID int,&#xD;&#xA;                                        @ERROR int OUT, &#xD;&#xA;                                        @ERRORTEXT nvarchar(1000) OUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_GETALLQUIZES]">
			<Property Name="BodyScript">
				<Value><![CDATA[
SET NOCOUNT ON
BEGIN												
	/* treating all negatives as max INT */
	DECLARE @InternalRecordsCount int = CASE WHEN @RecordsCount<0 THEN 2147483647 ELSE @RecordsCount END
SELECT	TOP (@InternalRecordsCount)  
A.QUIZ_ID as ID,
A.AUTHOR_ID as Author_Id ,
(SELECT FIRSTNAME+ ' '+LASTNAME FROM M_USERS C WHERE C.USER_ID = A.AUTHOR_ID ) as Author,
A.CREATED_DATE as Created_Date,
A.QUIZ_NAME as Quiz_Name,
CAST (A.SUCCESS_RATE as numeric(10,2)) as Success_Rate,
	( 
	SELECT 
		B.QUESTION_ID as Question_Id,
		B.QUIZ_ID as Quiz_Id,
		B.INFO as Info,
		B.[TEXT] as [Text],
		B.CORRECT_OPTION_FLAG as Correct_Option_Flag,
		(
		SELECT	
			C.VARIANT_ID as Variant_Id,
			C.QUESTION_ID as Question_Id,
			B.QUIZ_ID as Quiz_Id,
			C.[TEXT] as [Text]
			FROM  dbo.M_VARIANTS C WHERE C.QUESTION_ID= B.QUESTION_ID
		FOR XML PATH('Variant'),type) as Options 
	FROM  dbo.M_QUESTIONS B WHERE B.QUIZ_ID= A.QUIZ_ID
	FOR XML PATH('Question'),type)  as "Questions"
FROM dbo.M_QUIZES A
FOR XML PATH('Quiz'), type, root('ArrayOfQuiz')
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETALLQUIZES].[@RecordsCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[AUTHOR_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[FIRSTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[LASTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[AUTHOR_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[CREATED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[SUCCESS_RATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[INFO]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[TEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[CORRECT_OPTION_FLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[VARIANT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[TEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_GETALLQUIZES].[@RecordsCount]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[2147483647]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1145" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_GETALLQUIZES]&#xD;&#xA;@RecordsCount int = 2147483647 /* max INT value*/&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_GETALLUSERS]">
			<Property Name="BodyScript">
				<Value><![CDATA[
SET NOCOUNT ON
BEGIN												
	/* treating all negatives as max INT */
	DECLARE @InternalRecordsCount int = CASE WHEN @RecordsCount<0 THEN 2147483647 ELSE @RecordsCount END
	SELECT	TOP (@InternalRecordsCount)  
		[USER_ID], 
		[FIRSTNAME], 
		[LASTNAME], 
		[USERNAME], 
		[HASHEDPASSWORD], 
		[SALT],
		[ROLESFLAG], 
		CONVERT(nvarchar(23),[REGISTRATION_DATE],121) as [REGISTRATION_DATE] , 
		CONVERT(nvarchar(23),[LAST_LOGON_DATE],121) as [LAST_LOGON_DATE]
	FROM  dbo.V_M_USERS
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETALLUSERS].[@RecordsCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[V_M_USERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[V_M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[V_M_USERS].[FIRSTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[V_M_USERS].[LASTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[V_M_USERS].[USERNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[V_M_USERS].[HASHEDPASSWORD]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[V_M_USERS].[SALT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[V_M_USERS].[ROLESFLAG]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[V_M_USERS].[REGISTRATION_DATE]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[V_M_USERS].[LAST_LOGON_DATE]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_GETALLUSERS].[@RecordsCount]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[2147483647]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="253" />
				<Property Name="Length" Value="849" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Anton Metlyakov&#xD;&#xA;-- Create date: 02/12/2019&#xD;&#xA;-- Description:&#x9;RETURNS USER LIST&#xD;&#xA;-- Input : @RecordsCount, -1 - no limit&#xD;&#xA;-- returns : table&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[P_GETALLUSERS]&#xD;&#xA;@RecordsCount int = 2147483647 /* max INT value*/&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_GETNEXTPK]">
			<Property Name="BodyScript">
				<Value><![CDATA[
SET NOCOUNT ON
BEGIN
	IF NOT EXISTS (SELECT * FROM  [dbo].[S_PK_GENERATOR]  WHERE TABLE_NAME = @TABLE_NAME) 
		RAISERROR('Please add record for ''%s'' in PK generator table', 16, 1, @TABLE_NAME)
	 UPDATE [dbo].[S_PK_GENERATOR]  
	 SET TABLE_ID = TABLE_ID + 1,@ID = TABLE_ID + 1   
	 WHERE TABLE_NAME = @TABLE_NAME;
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[S_PK_GENERATOR]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[S_PK_GENERATOR].[TABLE_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@TABLE_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[S_PK_GENERATOR].[TABLE_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[S_PK_GENERATOR].[TABLE_NAME]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_GETNEXTPK].[@TABLE_NAME]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_GETNEXTPK].[@ID]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="18" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[numeric]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="293" />
				<Property Name="Length" Value="704" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Anton Metlyakov&#xD;&#xA;-- Create date: 02/12/2019&#xD;&#xA;-- Description:&#x9;Generates new identity number for given table name&#xD;&#xA;-- Input : table name&#xD;&#xA;-- returns : @ID int - next counter value&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[P_GETNEXTPK]&#xD;&#xA;@TABLE_NAME VARCHAR(30),&#xD;&#xA; @ID NUMERIC OUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_GETNEXTQUESTION]">
			<Property Name="BodyScript">
				<Value><![CDATA[
SET NOCOUNT ON
BEGIN												
-- execute [dbo].[P_GETNEXTQUESTION] @RecordCount=2, @QuizResultId=1
UPDATE [dbo].[M_QUIZ_RESULTS]
SET QUIZ_STATUS = 2, -- In progress
STARTED_DATE = GETDATE()
WHERE 
	QUIZ_RESULT_ID = @QuizResultId AND
	QUIZ_STATUS = 1  -- Assigned

  SELECT TOP (@RecordCount)
		 QR.USER_ID
		 ,Q.[QUESTION_ID] as [Question_Id]
		,Q.[QUIZ_ID] as [Quiz_Id]
		,Q.[INFO] as [Info]
		,Q.[TEXT] as [Text]
        ,Q.[CORRECT_OPTION_FLAG] as CorrectOptionFlag
		,(SELECT	
			V.VARIANT_ID as Variant_Id,
			V.QUESTION_ID as Question_Id,
			Q.QUIZ_ID as Quiz_Id,
			V.[TEXT] as [Text]
			FROM  dbo.M_VARIANTS V WHERE V.QUESTION_ID = Q.QUESTION_ID
		FOR XML PATH('Variant'),type) as Options 
   FROM [dbo].[M_QUIZ_RESULTS] QR 
  JOIN dbo.[M_QUESTIONS] Q ON QR.QUIZ_ID = Q.QUIZ_ID
  LEFT JOIN [dbo].[M_QUIZ_ANSWERS] QA ON Q.QUESTION_ID = QA.QUESTION_ID  AND QA.QUIZ_RESULT_ID = QR.QUIZ_RESULT_ID 
    WHERE 
	QR.QUIZ_RESULT_ID = @QuizResultId AND
	QA.QUIZ_ANSWERS_ID IS NULL
	ORDER BY Q.[QUESTION_ID]
	FOR XML PATH('Question'),type, root('ArrayOfQuestion')
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_STATUS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[STARTED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTQUESTION].[@QuizResultId]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTQUESTION].[@RecordCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[INFO]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[TEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[CORRECT_OPTION_FLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[VARIANT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[TEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_ANSWERS_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_GETNEXTQUESTION].[@RecordCount]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_GETNEXTQUESTION].[@QuizResultId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1192" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_GETNEXTQUESTION]&#xD;&#xA;@RecordCount int = 1,&#xD;&#xA;@QuizResultId int&#xD;&#xA;&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_GETQUIZ]">
			<Property Name="BodyScript">
				<Value><![CDATA[
SET NOCOUNT ON
BEGIN												

SELECT
A.QUIZ_ID as ID,
A.AUTHOR_ID as Author_Id,
(SELECT FIRSTNAME+ ' '+LASTNAME FROM M_USERS C WHERE C.USER_ID = A.AUTHOR_ID ) as Author,
A.CREATED_DATE as Created_Date,
A.QUIZ_NAME as Quiz_Name,
CAST (A.SUCCESS_RATE as numeric(10,2)) as Success_Rate,
	( 
	SELECT 
		B.QUESTION_ID as Question_Id,
		B.QUIZ_ID as Quiz_Id,
		B.INFO as Info,
		B.[TEXT] as [Text],
		B.CORRECT_OPTION_FLAG as CorrectOptionFlag,
		(
		SELECT	
			C.VARIANT_ID as Variant_Id,
			C.QUESTION_ID as Question_Id,
			B.QUIZ_ID as Quiz_Id,
			C.[TEXT] as [Text]
			FROM  dbo.M_VARIANTS C WHERE C.QUESTION_ID= B.QUESTION_ID
		FOR XML PATH('Variant'),type) as Options  
	FROM  dbo.M_QUESTIONS B where B.QUIZ_ID= A.QUIZ_ID
	FOR XML PATH('Question'),type)  as "Questions"
FROM dbo.M_QUIZES A
WHERE A.QUIZ_ID = @ID
FOR XML PATH('Quiz'), type


END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[AUTHOR_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[FIRSTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[LASTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[AUTHOR_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[CREATED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[SUCCESS_RATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[INFO]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[TEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[CORRECT_OPTION_FLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[VARIANT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[TEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETQUIZ].[@ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_GETQUIZ].[@ID]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="933" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_GETQUIZ]&#xD;&#xA;@ID int = 1&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_GETQUIZASSIGNMENT]">
			<Property Name="BodyScript">
				<Value><![CDATA[
SET NOCOUNT ON
BEGIN												
SELECT 
	@UserID as [User_Id],
	(SELECT USERNAME FROM dbo.M_USERS WHERE [USER_ID]=@UserID) as [User_Name],
	(SELECT 
		UserQuizList.QUIZ_ID as [Quiz_Id], 
		UserQuizList.QUIZ_NAME as Quiz_Name,
		ISNULL(QR.QUIZ_STATUS ,0) as Quiz_Status,
		ISNULL(QR.QUIZ_RESULT_ID,-1) as QuizResult_Id
		FROM
	(SELECT  U.USER_ID,U.USERNAME,  Q.QUIZ_NAME, Q.QUIZ_ID
	FROM M_USERS U
	CROSS JOIN M_QUIZES Q
	WHERE U.USER_ID = @UserID ) as UserQuizList
	LEFT JOIN dbo.M_QUIZ_RESULTS QR ON QR.QUIZ_ID = UserQuizList.QUIZ_ID AND QR.USER_ID = @UserID
	ORDER BY Quiz_Name
	FOR XML PATH('AssignQuizList'),type)  as [Assignquizlist]
FOR XML PATH('AssignQuiz'), type 
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[P_GETQUIZASSIGNMENT].[@UserID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USERNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USERNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_STATUS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_GETQUIZASSIGNMENT].[@UserID]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="763" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_GETQUIZASSIGNMENT]&#xD;&#xA;@UserID int = 1&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_GETQUIZRESULT]">
			<Property Name="BodyScript">
				<Value><![CDATA[
SET NOCOUNT ON
BEGIN												
SELECT
       [QUIZ_RESULT_ID] as [QuizResult_Id]
	  ,[USER_ID] as [User_Id]
	  ,(SELECT USERNAME FROM dbo.M_USERS Q WHERE Q.USER_ID =  QR.[USER_ID]) as [UserName]
      ,[QUIZ_ID] as [Quiz_Id]
	  ,(SELECT QUIZ_NAME FROM dbo.M_QUIZES Q WHERE Q.QUIZ_ID = QR.QUIZ_ID) as [Quiz_Name]
      ,(SELECT FIRSTNAME+ ' '+ LASTNAME FROM dbo.M_USERS Q WHERE Q.USER_ID =  QR.[ASSIGNED_BY_ID]) as [AssignedBy]
      ,[ASSIGNED_DATE] as [Assigned_Date]
      ,[QUIZ_STATUS] as [QuizResult_Status]
      ,[COMPLETED_DATE] as [Completed_Date]
	  ,[STARTED_DATE] as [Started_Date]
	  ,[TIME_TAKEN] as [Time_Taken]
      ,CAST([COMPLETED_RATE] as DECIMAL(6,4)) as [Completed_Rate]
	  ,(SELECT	
			QA.QUIZ_ANSWERS_ID as [Answer_Id],
			QA.QUIZ_RESULT_ID as [QuizResult_Id],
			QA.QUIZ_ID as [Quiz_Id],
			QA.QUESTION_ID as [Question_Id],
			QA.ANSWER_FLAG as [Answer_Flag],
			QA.[TIMESTAMP] as [TimeStamp]
			FROM  dbo.M_QUIZ_ANSWERS QA WHERE QA.QUIZ_RESULT_ID = QR.QUIZ_RESULT_ID
		FOR XML PATH('Answer'),type) as [Answer_List]
  FROM [dbo].[M_QUIZ_RESULTS] QR
  WHERE QR.QUIZ_RESULT_ID = @QuizResultId
  ORDER BY [Quiz_Name]
  FOR XML PATH('QuizResult'), type
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USERNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[FIRSTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[LASTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[ASSIGNED_BY_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[ASSIGNED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_STATUS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[STARTED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[TIME_TAKEN]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[decimal]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_RATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_ANSWERS_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[ANSWER_FLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[TIMESTAMP]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETQUIZRESULT].[@QuizResultId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_GETQUIZRESULT].[@QuizResultId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1272" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_GETQUIZRESULT]&#xD;&#xA;@QuizResultId int&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_GETQUIZRESULTS]">
			<Property Name="BodyScript">
				<Value><![CDATA[
SET NOCOUNT ON
BEGIN												
	/* treating all negatives as max INT */
	DECLARE @InternalRecordsCount int = CASE WHEN @RecordsCount<0 THEN 2147483647 ELSE @RecordsCount END

SELECT TOP (@InternalRecordsCount)
       [QUIZ_RESULT_ID] as [QuizResult_Id]
	  ,[USER_ID] as [User_Id]
	  ,(SELECT USERNAME FROM dbo.M_USERS Q WHERE Q.USER_ID =  QR.[USER_ID]) as [UserName]
      ,[QUIZ_ID] as [Quiz_Id]
	  ,(SELECT QUIZ_NAME FROM dbo.M_QUIZES Q WHERE Q.QUIZ_ID = QR.QUIZ_ID) as [Quiz_Name]
      ,(SELECT FIRSTNAME+ ' '+ LASTNAME FROM dbo.M_USERS Q WHERE Q.USER_ID =  QR.[ASSIGNED_BY_ID]) as [AssignedBy]
      ,[ASSIGNED_DATE] as [Assigned_Date]
      ,[COMPLETED_DATE]as [Completed_Date]
      ,[QUIZ_STATUS] as [QuizResult_Status]
      ,[COMPLETED_RATE] as [Completed_Rate]
	  ,[STARTED_DATE] as [Started_Date]
	  ,[TIME_TAKEN] as [Time_Taken]
	  ,(SELECT	
			QA.QUIZ_ANSWERS_ID as [Answer_Id],
			QA.QUIZ_RESULT_ID as [QuizResult_Id],
			QA.QUIZ_ID as [Quiz_Id],
			QA.QUESTION_ID as [Question_Id],
			QA.ANSWER_FLAG as [Answer_Flag],
			QA.[TIMESTAMP] as [TimeStamp]
			FROM  dbo.M_QUIZ_ANSWERS QA WHERE QA.QUIZ_RESULT_ID = QR.QUIZ_RESULT_ID
		FOR XML PATH('Answer'),type) as [Answer_List]
  FROM [dbo].[M_QUIZ_RESULTS] QR
  WHERE QR.USER_ID = @UserId
  FOR XML PATH('QuizResult'), type, root('ArrayOfQuizResult')
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETQUIZRESULTS].[@RecordsCount]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USERNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[FIRSTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[LASTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[ASSIGNED_BY_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[ASSIGNED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_STATUS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_RATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[STARTED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[TIME_TAKEN]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_ANSWERS_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[ANSWER_FLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[TIMESTAMP]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETQUIZRESULTS].[@UserId]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_GETQUIZRESULTS].[@RecordsCount]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[2147483647]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_GETQUIZRESULTS].[@UserId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1461" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_GETQUIZRESULTS]&#xD;&#xA;@RecordsCount int = 2147483647, /* max INT value*/&#xD;&#xA;@UserId int&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_RECORDLOG]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	SET NOCOUNT ON;
				DECLARE @NEWID NUMERIC;
				EXECUTE dbo.P_GETNEXTPK @TABLE_NAME = 'T_LOG', @ID = @NEWID OUT
				INSERT INTO dbo.T_LOG 
					([Id],[Date],[Thread],[Level],[Logger],[Message],[Exception])
					VALUES (@NEWID, @log_date, @thread, @log_level, @logger, @message, @exception)	
	RETURN 0
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@TABLE_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[T_LOG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[T_LOG].[Id]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[T_LOG].[Date]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[T_LOG].[Thread]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[T_LOG].[Level]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[T_LOG].[Logger]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[T_LOG].[Message]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[T_LOG].[Exception]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_RECORDLOG].[@log_date]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_RECORDLOG].[@thread]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_RECORDLOG].[@log_level]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_RECORDLOG].[@logger]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_RECORDLOG].[@message]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_RECORDLOG].[@exception]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_RECORDLOG].[@log_date]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_RECORDLOG].[@thread]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_RECORDLOG].[@log_level]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_RECORDLOG].[@logger]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_RECORDLOG].[@message]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="4000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_RECORDLOG].[@exception]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="270" />
				<Property Name="Length" Value="845" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Anton Metlyakov&#xD;&#xA;-- Create date: 02/17/2019&#xD;&#xA;-- Description:&#x9;Saves log record to table T_LOG &#xD;&#xA;-- Input : log info fields&#xD;&#xA;-- return : @error number, if any&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[P_RECORDLOG]&#xD;&#xA;&#x9;@log_date datetime,&#xD;&#xA;&#x9;@thread varchar(255), &#xD;&#xA;&#x9;@log_level varchar(50),&#xD;&#xA;&#x9;@logger varchar(255),&#xD;&#xA;&#x9;@message nvarchar(4000), &#xD;&#xA;&#x9;@exception nvarchar(2000) &#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_SAVEANSWER]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SET @ERROR = 0;
	SET @ERRORTEXT = N'Ok';
	IF ( NOT EXISTS(SELECT * FROM dbo.M_QUESTIONS WHERE QUESTION_ID = @QuestionID) OR 
	   NOT EXISTS(SELECT * FROM dbo.M_QUIZ_RESULTS WHERE QUIZ_RESULT_ID = @QuizResultId))
	/* DB consistency error */
		SELECT @ERROR = -1,	@ERRORTEXT = N'No Quiz|Question|Result '+ CAST(@QuizResultId as nvarchar(10)) + N' in M_QUESTIONS|M_QUIZ_RESULTS table';
	ELSE
	BEGIN
		IF (@AnswerID >0) 
		BEGIN
			SELECT @ERROR = -2,	@ERRORTEXT = N' AnswerID '+ CAST(@AnswerID as nvarchar(10)) + N' is positive. No updates allowed';
		END
		ELSE
		BEGIN
			BEGIN TRY
				/* new record */
				DECLARE @NEWID NUMERIC;
				EXECUTE dbo.P_GETNEXTPK @TABLE_NAME = 'M_QUIZ_ANSWERS', @ID = @NEWID OUT
				INSERT INTO dbo.[M_QUIZ_ANSWERS]
					([QUIZ_ANSWERS_ID], [QUIZ_RESULT_ID], [QUIZ_ID], [QUESTION_ID],[ANSWER_FLAG], [TIMESTAMP])
					VALUES (
						@NEWID,
						@QuizResultId,
						(SELECT QUIZ_ID FROM dbo.[M_QUIZ_RESULTS] QR WHERE QR.QUIZ_RESULT_ID = @QuizResultId),
						@QuestionID,
						@AnswerFlag,
						GETDATE())
			END TRY
			BEGIN CATCH
				SELECT @ERROR = ERROR_NUMBER(), @ERRORTEXT = ERROR_MESSAGE();
			END CATCH
		END
	END

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEANSWER].[@ERROR]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEANSWER].[@ERRORTEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEANSWER].[@QuestionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEANSWER].[@QuizResultId]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEANSWER].[@AnswerID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@TABLE_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_ANSWERS_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[ANSWER_FLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[TIMESTAMP]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEANSWER].[@AnswerFlag]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEANSWER].[@QuizResultId]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEANSWER].[@QuestionID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEANSWER].[@AnswerID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEANSWER].[@AnswerFlag]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEANSWER].[@ERROR]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEANSWER].[@ERRORTEXT]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1694" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_SAVEANSWER]&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;@QuizResultId int,&#xD;&#xA;                                        @QuestionID int , &#xD;&#xA;                                        @AnswerID int,&#xD;&#xA;                                        @AnswerFlag int,&#xD;&#xA;                                        @ERROR int OUT, &#xD;&#xA;                                        @ERRORTEXT nvarchar(1000) OUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_SAVEQUESTION]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SET @ERROR = 0;
	SET @ERRORTEXT = N'Ok';
	IF NOT EXISTS(SELECT * FROM dbo.M_QUIZES WHERE QUIZ_ID  = @QuizID)
	/* DB consistency error */
		SELECT @ERROR = -1,	@ERRORTEXT = N'No Quiz '+ CAST(@QuizID as nvarchar(10)) + N' in M_QUIZES table';
	ELSE
	BEGIN
		BEGIN TRY
			IF (EXISTS(SELECT * FROM dbo.[M_QUESTIONS] Q WHERE Q.QUESTION_ID = @QuestionID AND Q.QUIZ_ID = @QuizID)
				AND @QuestionID >0)
			BEGIN
			/* update record */
				UPDATE dbo.[M_QUESTIONS]
				SET 
					[INFO] = @info, [TEXT] = @text, [CORRECT_OPTION_FLAG] = @CorrectOptionFlag
				WHERE 
					QUESTION_ID = @QuestionID AND QUIZ_ID = @QuizID
			END
			ELSE
			BEGIN
			/* new record */
				DECLARE @NEWID NUMERIC;
				EXECUTE dbo.P_GETNEXTPK @TABLE_NAME = 'M_QUESTIONS', @ID = @NEWID OUT
				INSERT INTO dbo.[M_QUESTIONS]
				([QUIZ_ID], [QUESTION_ID],[INFO], [TEXT],[CORRECT_OPTION_FLAG])
				VALUES (@QuizID, @NEWID,@info, @text,@CorrectOptionFlag)
			END
		END TRY
		BEGIN CATCH
			SELECT @ERROR = ERROR_NUMBER(), @ERRORTEXT = ERROR_MESSAGE();
		END CATCH
	END

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUESTION].[@ERROR]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUESTION].[@ERRORTEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUESTION].[@QuizID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUESTION].[@QuestionID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[INFO]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUESTION].[@info]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[TEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUESTION].[@text]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[CORRECT_OPTION_FLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUESTION].[@CorrectOptionFlag]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@TABLE_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUESTION].[@QuizID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUESTION].[@QuestionID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUESTION].[@info]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUESTION].[@text]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUESTION].[@CorrectOptionFlag]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUESTION].[@ERROR]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUESTION].[@ERRORTEXT]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1678" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_SAVEQUESTION]&#xD;&#xA;                                        @QuizID int , &#xD;&#xA;                                        @QuestionID int , &#xD;&#xA;                                        @info nvarchar(1000) ,&#xD;&#xA;                                        @text nvarchar(1000),&#xD;&#xA;                                        @CorrectOptionFlag int,&#xD;&#xA;                                        @ERROR int OUT, &#xD;&#xA;                                        @ERRORTEXT nvarchar(1000) OUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_SAVEQUIZ]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SET @ERROR = 0;
	SET @ERRORTEXT = N'Ok';
BEGIN TRY
		IF (@QuizID = -1) 
		BEGIN
		/* new quiz */
			IF EXISTS(SELECT * FROM dbo.M_QUIZES WHERE QUIZ_NAME = @QuizName)
				SELECT @ERROR = -1,	@ERRORTEXT = N'Dublicate Quiz name '+@QuizName + N' in M_QUIZES table';
			ELSE
			BEGIN
				DECLARE @NEWID NUMERIC;
				EXECUTE dbo.P_GETNEXTPK @TABLE_NAME = 'M_QUIZES', @ID = @NEWID OUT
				INSERT INTO dbo.M_QUIZES 
				([QUIZ_ID],[QUIZ_NAME], [AUTHOR_ID], [CREATED_DATE], [SUCCESS_RATE])
					VALUES (@NEWID,@QuizName,@AuthorID,GETDATE(),@SuccessRate)
			END
		END
		ELSE
		BEGIN
		/* Update existing quiz info */
			IF NOT EXISTS(SELECT * FROM dbo.M_QUIZES WHERE QUIZ_ID = @QuizID)
			/* DB consistency error */
				SELECT @ERROR = -1,	@ERRORTEXT = N'No Quiz '+CAST(@QuizID as nvarchar(10)) + N' in M_QUIZES table';
			ELSE
			BEGIN
			/* change quiz name of existing quiz. Is new Quiz name free ?*/
				IF EXISTS(SELECT * FROM dbo.M_QUIZES WHERE [QUIZ_NAME] = @QuizName AND QUIZ_ID != @QuizID )
					SELECT @ERROR = -1,	@ERRORTEXT = N'Can''t change quiz name to '+@QuizName + N' in M_QUIZES table, this quiz name already exists';
				ELSE
					UPDATE dbo.M_QUIZES 
					SET [QUIZ_NAME] = @QuizName,
						[AUTHOR_ID] = @AuthorID,
						[SUCCESS_RATE] = @SuccessRate
					WHERE [QUIZ_ID] = @QuizID
			END
		END
	END TRY
	BEGIN CATCH
		SELECT @ERROR = ERROR_NUMBER(), @ERRORTEXT = ERROR_MESSAGE();
	END CATCH

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUIZ].[@ERROR]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUIZ].[@ERRORTEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUIZ].[@QuizID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUIZ].[@QuizName]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@TABLE_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[AUTHOR_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[CREATED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[SUCCESS_RATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUIZ].[@AuthorID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUIZ].[@SuccessRate]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUIZ].[@QuizID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUIZ].[@QuizName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUIZ].[@AuthorID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUIZ].[@CreatedDate]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUIZ].[@SuccessRate]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[real]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUIZ].[@ERROR]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUIZ].[@ERRORTEXT]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="2046" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_SAVEQUIZ]&#xD;&#xA;                                        @QuizID int, &#xD;&#xA;                                        @QuizName nvarchar(100),&#xD;&#xA;                                        @AuthorID int, &#xD;&#xA;                                        @CreatedDate datetime,&#xD;&#xA;                                        @SuccessRate real,&#xD;&#xA;                                        @ERROR int OUT, &#xD;&#xA;                                        @ERRORTEXT nvarchar(1000) OUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_SAVEQUIZASSIGNMENT]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SET NOCOUNT ON;
	SET @ERROR = 0;
	SET @ERRORTEXT = N'Ok';
	SELECT @XmlQuizes = REPLACE(@XmlQuizes,'\','')			-- убираю лишние символы - \
	SELECT @XmlQuizes = SUBSTRING(@XmlQuizes,2,LEN(@XmlQuizes)-2) -- убираю лишние символы - ".."
	DECLARE @xml xml = @XmlQuizes 
	DECLARE @NEWID numeric
	DECLARE @AssignedUser_Id int
	DECLARE @User_Id int
	DECLARE @Quiz_Id int
	DECLARE @Quiz_Status int
	DECLARE @QuizResult_Id int

	BEGIN TRY
		SELECT @User_Id = Table1.user_id.value('.','int') 
		FROM   @xml.nodes('/AssignQuiz/User_Id') Table1(user_id)
		SELECT @AssignedUser_Id = Table1.user_id.value('.','int') 
		FROM   @xml.nodes('/AssignQuiz/AssignedUser_Id') Table1(user_id)
		DECLARE QuizAssignment CURSOR FOR
				SELECT @User_Id as User_id,
					col.query('Quiz_Id').value('.','int') as Quiz_Id,
					col.query('Quiz_Status').value('.','int') as Quiz_Status,
					col.query('QuizResult_Id').value('.','int') as QuizResult_Id
				FROM @xml.nodes('/AssignQuiz/Assignquizlist/AssignQuizList') as i(col)
		OPEN QuizAssignment

		WHILE (1=1)
		BEGIN
			FETCH NEXT FROM QuizAssignment INTO @User_Id, @Quiz_Id, @Quiz_Status, @QuizResult_Id
			IF (@@FETCH_STATUS !=0) BREAK
	-- обработка строки назначенных квизов
	-- логика  :
	--	Quiz_Status и QuizResult_Id ==0 - такую комбинацию пропускаю (не назначено)
	--	QuizResult_Id ==0, Quiz_Status ==1 - добавить в M_QuizResults
	--	QuizResult_Id >0  Quiz_Status == 0 - удалить из M_QuizResults
	--	QuizResult_Id <=0  Quiz_Status == 1  такую комбинацию пропускаю  (было ранее назначено)
			IF (@QuizResult_Id <= 0) AND (@Quiz_Status = 1)
			BEGIN
			-- insert into M_QUIZ_RESULTS	
				EXECUTE dbo.P_GETNEXTPK @TABLE_NAME = 'M_QUIZ_RESULTS', @ID = @NEWID OUT
				INSERT INTO dbo.M_QUIZ_RESULTS
					(QUIZ_RESULT_ID, USER_ID, QUIZ_ID,QUIZ_STATUS, ASSIGNED_BY_ID,ASSIGNED_DATE, COMPLETED_RATE,COMPLETED_DATE)
					VALUES 
					(@NEWID, @User_Id,@Quiz_Id,1 /*Assigned*/,@AssignedUser_Id, GETDATE(), NULL,NULL)
			END
			IF (@QuizResult_Id > 0) AND (@Quiz_Status = 0)
			BEGIN
			-- delete FROM M_QUIZ_RESULTS	
				DELETE FROM dbo.M_QUIZ_RESULTS
					WHERE QUIZ_RESULT_ID = @QuizResult_Id AND
						QUIZ_STATUS = 1	-- Assigned (Passed, Failed, InProgress - do not delete)
			END
		END
		CLOSE QuizAssignment
		DEALLOCATE QuizAssignment
	END TRY
	BEGIN CATCH
		SELECT @ERROR = ERROR_NUMBER(), @ERRORTEXT = ERROR_MESSAGE();
	END CATCH
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[xml]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUIZASSIGNMENT].[@XmlQuizes]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUIZASSIGNMENT].[@ERROR]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUIZASSIGNMENT].[@ERRORTEXT]" />
				</Entry>
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@TABLE_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_STATUS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[ASSIGNED_BY_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[ASSIGNED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_RATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_DATE]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUIZASSIGNMENT].[@XmlQuizes]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUIZASSIGNMENT].[@ERROR]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUIZASSIGNMENT].[@ERRORTEXT]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="2647" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_SAVEQUIZASSIGNMENT]&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;@XmlQuizes nvarchar(max)&#xD;&#xA;                                        ,@ERROR int OUT, &#xD;&#xA;                                        @ERRORTEXT nvarchar(1000) OUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_SAVEQUIZRESULT]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	/*  test script
	DECLARE @error int, @Errortext nvarchar(1000)
	 execute [dbo].[P_SAVEQUZRESULT] 1, @Error out, @errortext out
 */
	SET NOCOUNT ON;
	SET @ERROR = 0;
	SET @ERRORTEXT = N'Ok';
	IF NOT EXISTS(SELECT * FROM dbo.M_QUIZ_RESULTS WHERE QUIZ_RESULT_ID = @QuizResultID)
				SELECT @ERROR = -1,	@ERRORTEXT = N'NO QuizResult '+CAST(@QuizResultID as nvarchar(10)) + N' in M_QUIZ_RESULTS table';
	ELSE
	BEGIN
		BEGIN TRY
		;WITH Save_Quiz_Result AS
		(SELECT 
				QR.QUIZ_RESULT_ID as QUIZRESULTID,
				(SELECT SUCCESS_RATE FROM [dbo].[M_QUIZES] QQ WHERE QQ.QUIZ_ID = QR.QUIZ_ID) 
				as SuccessRate,
				CASE WHEN COUNT(Q.QUESTION_ID) >0 THEN  /* не хочу делить на ноль */
					CAST(SUM (CASE WHEN Q.CORRECT_OPTION_FLAG = QA.ANSWER_FLAG THEN 1 ELSE 0 END ) as real) /* Сумма правильных ответов/ сумму вопросов*/
					/ CAST(COUNT(Q.QUESTION_ID) as real)
				ELSE 0 END
				as CompletedRate,
				QR.STARTED_DATE as [Start_Date],
				GETDATE() as Completed_Date 
		  FROM [dbo].[M_QUESTIONS] Q
		  JOIN [dbo].[M_QUIZ_RESULTS] QR ON QR.QUIZ_ID = Q.QUIZ_ID
		  LEFT JOIN [dbo].[M_QUIZ_ANSWERS] QA ON QR.QUIZ_RESULT_ID = QA.QUIZ_RESULT_ID AND QA.QUESTION_ID = Q.QUESTION_ID
		  WHERE 
			QR.QUIZ_RESULT_ID = @QuizResultID
		  GROUP BY 
			QR.QUIZ_RESULT_ID , QR.QUIZ_ID , QR.STARTED_DATE
		)
		UPDATE dbo.M_QUIZ_RESULTS 
		SET COMPLETED_RATE = QR.CompletedRate,
			COMPLETED_DATE = GETDATE(),
			TIME_TAKEN = dbo.F_PRINT_DATEDIFF(QR.START_DATE,GETDATE()),
			QUIZ_STATUS = CASE WHEN SuccessRate > CompletedRate THEN 4 ELSE 3 END /* 4 = failed , 3 = passed */
		FROM 
			Save_Quiz_Result QR
		WHERE 
			QUIZ_RESULT_ID = QR.QUIZRESULTID
		END TRY
		BEGIN CATCH
			SELECT @ERROR = ERROR_NUMBER(), @ERRORTEXT = ERROR_MESSAGE();
		END CATCH
	END
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[P_SAVEQUIZRESULT].[@ERROR]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUIZRESULT].[@ERRORTEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEQUIZRESULT].[@QuizResultID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[SUCCESS_RATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[real]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[CORRECT_OPTION_FLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[ANSWER_FLAG]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[real]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[STARTED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[STARTED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_RATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[TIME_TAKEN]" />
				</Entry>
				<Entry>
					<References Name="[DBO].[F_PRINT_DATEDIFF]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[STARTED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_STATUS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[P_SAVEQUIZRESULT].[CTE1].[Save_Quiz_Result]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_SAVEQUIZRESULT].[CTE1].[Save_Quiz_Result].[QUIZRESULTID]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_SAVEQUIZRESULT].[CTE1].[Save_Quiz_Result].[SuccessRate]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_SAVEQUIZRESULT].[CTE1].[Save_Quiz_Result].[CompletedRate]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_SAVEQUIZRESULT].[CTE1].[Save_Quiz_Result].[Start_Date]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[M_QUIZ_RESULTS].[STARTED_DATE]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_SAVEQUIZRESULT].[CTE1].[Save_Quiz_Result].[Completed_Date]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUIZRESULT].[@QuizResultID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUIZRESULT].[@ERROR]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEQUIZRESULT].[@ERRORTEXT]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="2134" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_SAVEQUIZRESULT]&#xD;&#xA;                                        @QuizResultID int, &#xD;&#xA;                                        @ERROR int OUT, &#xD;&#xA;                                        @ERRORTEXT nvarchar(1000) OUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_SAVEUSER]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SET @ERROR = 0;
	SET @ERRORTEXT = N'Ok';
	BEGIN TRY
		IF (@USERID = -1) 
		BEGIN
		/* new user */
			IF EXISTS(SELECT * FROM dbo.M_USERS WHERE USERNAME = @USERNAME)
				SELECT @ERROR = -1,	@ERRORTEXT = N'Dublicate Username '+@USERNAME + N' in M_USERS table';
			ELSE
			BEGIN
				DECLARE @NEWID NUMERIC;
				EXECUTE dbo.P_GETNEXTPK @TABLE_NAME = 'M_USERS', @ID = @NEWID OUT
				INSERT INTO dbo.M_USERS (USER_ID,FIRSTNAME,LASTNAME,USERNAME, HASHEDPASSWORD, SALT, ROLESFLAG,[REGISTRATION_DATE],[LAST_LOGON_DATE] )
					VALUES (@NEWID,@FIRSTNAME,@LASTNAME,@USERNAME,@HASHEDPASSWORD,@SALT,@ROLESFLAG, GETDATE(), NULL)
			END
		END
		ELSE
		BEGIN
		/* Update existing user info */
			IF NOT EXISTS(SELECT * FROM dbo.M_USERS WHERE USER_ID = @USERID)
			/* DB consistency error */
				SELECT @ERROR = -1,	@ERRORTEXT = N'No Username '+@USERNAME + N' in M_USERS table';
			ELSE
			BEGIN
			/* change username of existing user. Is new username free ?*/
				IF EXISTS(SELECT * FROM dbo.M_USERS WHERE USERNAME = @USERNAME AND USER_ID != @USERID )
					SELECT @ERROR = -1,	@ERRORTEXT = N'Can''t change Username to '+@USERNAME + N' in M_USERS table, this username already exists';
				ELSE
					UPDATE dbo.M_USERS 
					SET USERNAME = @USERNAME,
						FIRSTNAME = @FIRSTNAME,
						LASTNAME = @LASTNAME,
						HASHEDPASSWORD = @HASHEDPASSWORD,
						ROLESFLAG = @ROLESFLAG
					WHERE USER_ID = @USERID
			END
		END
		IF (LEN(@LastLogonDate) >0)
		BEGIN
			UPDATE dbo.M_USERS 
			SET LAST_LOGON_DATE = CAST(@LastLogonDate as datetime)
			WHERE USER_ID  = @USERID
		END
	END TRY
	BEGIN CATCH
		SELECT @ERROR = ERROR_NUMBER(), @ERRORTEXT = ERROR_MESSAGE();
	END CATCH
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEUSER].[@ERROR]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEUSER].[@ERRORTEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEUSER].[@USERID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USERNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEUSER].[@USERNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@TABLE_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[FIRSTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[LASTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USERNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[HASHEDPASSWORD]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[SALT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[ROLESFLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[REGISTRATION_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[LAST_LOGON_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEUSER].[@FIRSTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEUSER].[@LASTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEUSER].[@HASHEDPASSWORD]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEUSER].[@SALT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEUSER].[@ROLESFLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEUSER].[@LastLogonDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEUSER].[@USERID]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[-1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEUSER].[@USERNAME]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEUSER].[@FIRSTNAME]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEUSER].[@LASTNAME]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEUSER].[@HASHEDPASSWORD]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEUSER].[@SALT]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEUSER].[@ROLESFLAG]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEUSER].[@LastLogonDate]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEUSER].[@ERROR]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEUSER].[@ERRORTEXT]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="100" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="297" />
				<Property Name="Length" Value="2425" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;Anton Metlyakov&#xD;&#xA;-- Create date: 02/12/2019&#xD;&#xA;-- Description:&#x9;Saves user to table M_USERS (new (id=-1)/update (id&gt;=0))&#xD;&#xA;-- Input : user info fields&#xD;&#xA;-- return : @error number, if any&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [dbo].[P_SAVEUSER]&#xD;&#xA;&#x9;&#x9;@USERID int=-1,&#xD;&#xA;&#x9;@USERNAME nvarchar(100),&#xD;&#xA;&#x9;@FIRSTNAME nvarchar(100),&#xD;&#xA;&#x9;@LASTNAME nvarchar(100),&#xD;&#xA;&#x9;@HASHEDPASSWORD nvarchar(100),&#xD;&#xA;&#x9;@SALT nvarchar(100),&#xD;&#xA;&#x9;@ROLESFLAG int = 1,&#xD;&#xA;&#x9;@LastLogonDate nvarchar(50),&#xD;&#xA;&#x9;@ERROR int out,&#xD;&#xA;&#x9;@ERRORTEXT nvarchar(100) out&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_SAVEVARIANT]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SET @ERROR = 0;
	SET @ERRORTEXT = N'Ok';
	IF NOT EXISTS(SELECT * FROM dbo.M_QUIZES WHERE QUIZ_ID  = @QuizID) OR NOT EXISTS(SELECT * FROM dbo.M_QUESTIONS WHERE QUESTION_ID  = @QuestionID)
	/* DB consistency error */
		SELECT @ERROR = -1,	@ERRORTEXT = N'No Quiz/Questiuon '+ CAST(@QuizID as nvarchar(10)) + N' in M_QUIZES/M_QUESTIONS table';
	ELSE
	BEGIN
		BEGIN TRY
			IF (EXISTS(SELECT * FROM dbo.[M_VARIANTS] V WHERE V.QUESTION_ID = @QuestionID )
				AND @VariantID >0)
			BEGIN
			/* update record */
				UPDATE dbo.[M_VARIANTS]
				SET 
					[TEXT] = @text
				WHERE 
					QUESTION_ID = @QuestionID AND VARIANT_ID = @VariantID
			END
			ELSE
			BEGIN
			/* new record */
				DECLARE @NEWID NUMERIC;
				EXECUTE dbo.P_GETNEXTPK @TABLE_NAME = 'M_VARIANTS', @ID = @NEWID OUT
				INSERT INTO dbo.[M_VARIANTS]
				([QUESTION_ID],[VARIANT_ID], [TEXT])
				VALUES (@QuestionID, @NEWID, @text)
			END
		END TRY
		BEGIN CATCH
			SELECT @ERROR = ERROR_NUMBER(), @ERRORTEXT = ERROR_MESSAGE();
		END CATCH
	END

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEVARIANT].[@ERROR]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEVARIANT].[@ERRORTEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEVARIANT].[@QuizID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEVARIANT].[@QuestionID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEVARIANT].[@VariantID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[TEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_SAVEVARIANT].[@text]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_VARIANTS].[VARIANT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@TABLE_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_GETNEXTPK].[@ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEVARIANT].[@QuizID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEVARIANT].[@QuestionID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEVARIANT].[@VariantID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEVARIANT].[@text]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEVARIANT].[@ERROR]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_SAVEVARIANT].[@ERRORTEXT]">
						<Property Name="IsOutput" Value="True" />
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1545" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_SAVEVARIANT]&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;@QuizID int , &#xD;&#xA;                                        @QuestionID int , &#xD;&#xA;                                        @VariantID int,&#xD;&#xA;                                        @text nvarchar(1000),&#xD;&#xA;                                        @ERROR int OUT, &#xD;&#xA;                                        @ERRORTEXT nvarchar(1000) OUT&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_STATSALLQUIZES]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	;WITH RawViewCTE AS
	(
		SELECT 
		Q.QUIZ_NAME as Quiz_Name,
		Q.SUCCESS_RATE as Success_Rate,
			(SELECT COUNT(*) fROM dbo.M_QUIZ_RESULTS QR WHERE QR.QUIZ_ID = Q.QUIZ_ID) 
		as Total_Assigned,
			(SELECT COUNT(*) fROM dbo.M_QUIZ_RESULTS QR WHERE QR.QUIZ_ID = Q.QUIZ_ID AND QR.QUIZ_STATUS = 3) 
		as Total_Passed,
			(SELECT COUNT(*) fROM dbo.M_QUIZ_RESULTS QR WHERE QR.QUIZ_ID = Q.QUIZ_ID AND QR.QUIZ_STATUS = 4) 
		as Total_Failed,
			ISNULL(CAST(CAST((SELECT AVG(COMPLETED_RATE) fROM dbo.M_QUIZ_RESULTS QR WHERE QR.QUIZ_ID = Q.QUIZ_ID) as numeric(5,2)) as nvarchar(5)),'n/a') 
		as Average_Rate
		FROM dbo.M_QUIZES Q
	)
	SELECT R.Quiz_Name, R.Success_Rate, R.Total_Assigned, R.Total_Passed, R.Total_Failed,R.Average_Rate,
		CAST(CASE WHEN R.Total_Assigned =0 THEN  0
		ELSE CAST (R.Total_Passed as real)/ CAST(R.Total_Assigned as real) * 100.0
		END as numeric(6,2))
	as Percent_Passed
	FROM RawViewCTE R
	ORDER BY [Quiz_Name]
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[SUCCESS_RATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_STATUS]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_RATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[SUCCESS_RATE]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[real]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[real]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[P_STATSALLQUIZES].[CTE1].[RawViewCTE]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_STATSALLQUIZES].[CTE1].[RawViewCTE].[Quiz_Name]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_STATSALLQUIZES].[CTE1].[RawViewCTE].[Success_Rate]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[M_QUIZES].[SUCCESS_RATE]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_STATSALLQUIZES].[CTE1].[RawViewCTE].[Total_Assigned]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_STATSALLQUIZES].[CTE1].[RawViewCTE].[Total_Passed]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_STATSALLQUIZES].[CTE1].[RawViewCTE].[Total_Failed]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_STATSALLQUIZES].[CTE1].[RawViewCTE].[Average_Rate]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1129" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_STATSALLQUIZES]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_STATSALLUSERS]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	;WITH RawViewCTE AS
	(
		SELECT 
		U.USERNAME,
			(SELECT COUNT(*) fROM dbo.M_QUIZ_RESULTS QR WHERE QR.USER_ID = U.USER_ID) 
		as Total_Assigned,
			(SELECT COUNT(*) fROM dbo.M_QUIZ_RESULTS QR WHERE  QR.USER_ID = U.USER_ID AND QR.QUIZ_STATUS = 3) 
		as Total_Passed,
			(SELECT COUNT(*) fROM dbo.M_QUIZ_RESULTS QR WHERE  QR.USER_ID = U.USER_ID AND QR.QUIZ_STATUS = 4) 
		as Total_Failed,
			ISNULL(CAST(CAST((SELECT AVG(COMPLETED_RATE) fROM dbo.M_QUIZ_RESULTS QR WHERE  QR.USER_ID = U.USER_ID) as numeric(6,2)) as nvarchar(5)),'') 
		as AVG_RATE
		FROM dbo.M_USERS U
	)
	SELECT
		 R.USERNAME as [User_Name],
		 R.Total_Assigned, 
		 R.Total_Passed, 
		 R.Total_Failed,
		 R.AVG_RATE as Average_Rate,
		CAST(CASE WHEN R.Total_Assigned =0 THEN  0
		ELSE CAST (R.Total_Passed as real)/ CAST(R.Total_Assigned as real) * 100.0
		END as numeric(6,2))
	as Percent_Passed
	FROM RawViewCTE R
	ORDER BY [User_Name]
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USERNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_STATUS]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_RATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USERNAME]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[real]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[real]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[dbo].[P_STATSALLUSERS].[CTE1].[RawViewCTE]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_STATSALLUSERS].[CTE1].[RawViewCTE].[USERNAME]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[dbo].[M_USERS].[USERNAME]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_STATSALLUSERS].[CTE1].[RawViewCTE].[Total_Assigned]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_STATSALLUSERS].[CTE1].[RawViewCTE].[Total_Passed]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_STATSALLUSERS].[CTE1].[RawViewCTE].[Total_Failed]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[dbo].[P_STATSALLUSERS].[CTE1].[RawViewCTE].[AVG_RATE]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1107" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_STATSALLUSERS]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_STATSBYQUIZ]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SELECT 
		U.[USER_ID] as [User_Id], 
		U.USERNAME as [User_Name], 
		CASE  ISNULL((SELECT QR.QUIZ_STATUS FROM dbo.M_QUIZ_RESULTS QR WHERE QR.USER_ID = U.USER_ID AND QR.QUIZ_ID = @Quiz_ID),0)
			WHEN 0 THEN 'Not assigned'
			WHEN 1 THEN 'Assigned'
			WHEN 2 THEN 'In progress'
			WHEN 3 THEN 'Passed'
			WHEN 4 THEN 'Failed'
		END as Quiz_Status,
		ISNULL(CAST(CAST((SELECT QR.COMPLETED_RATE FROM dbo.M_QUIZ_RESULTS QR WHERE QR.USER_ID = U.USER_ID AND QR.QUIZ_ID = @Quiz_ID) as numeric(6,2)) as nvarchar(6)),'') 
		as Completed_Rate, 
		ISNULL(CONVERT(nvarchar(19),(SELECT QR.COMPLETED_DATE FROM dbo.M_QUIZ_RESULTS QR WHERE QR.USER_ID = U.USER_ID AND QR.QUIZ_ID = @Quiz_ID),121),'') 
		as Completed_Date,
		ISNULL(CONVERT(nvarchar(19),(SELECT QR.STARTED_DATE FROM dbo.M_QUIZ_RESULTS QR WHERE QR.USER_ID = U.USER_ID AND QR.QUIZ_ID = @Quiz_ID),121),'') 
		as Started_Date,
		ISNULL(
			  (SELECT dbo.[F_PRINT_DATEDIFF](QR.STARTED_DATE,QR.COMPLETED_DATE) FROM dbo.M_QUIZ_RESULTS QR 
					WHERE QR.QUIZ_ID = @QUIZ_ID AND QR.USER_ID = U.USER_ID)
		,'') as [Time_taken]
	FROM dbo.M_USERS U
	order by [User_Name]
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USERNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_STATUS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_STATSBYQUIZ].[@Quiz_ID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_RATE]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_DATE]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[STARTED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[DBO].[F_PRINT_DATEDIFF]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_STATSBYQUIZ].[@Quiz_ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1316" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [dbo].[P_STATSBYQUIZ]&#xD;&#xA;@Quiz_ID int &#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[dbo].[P_STATSBYUSER]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SET NOCOUNT ON;
	SELECT 
		Q.QUIZ_ID as [Quiz_Id],
		Q.QUIZ_NAME as [Quiz_Name],
		CASE  ISNULL((SELECT QR.QUIZ_STATUS FROM dbo.M_QUIZ_RESULTS QR WHERE QR.QUIZ_ID = Q.QUIZ_ID AND QR.USER_ID = @USER_ID),0)
			WHEN 0 THEN 'Not assigned'
			WHEN 1 THEN 'Assigned'
			WHEN 2 THEN 'In progress'
			WHEN 3 THEN 'Passed'
			WHEN 4 THEN 'Failed'
		END as Quiz_Status,
		ISNULL(
			CAST(
				CAST(
					(SELECT QR.COMPLETED_RATE FROM dbo.M_QUIZ_RESULTS QR WHERE QR.QUIZ_ID = Q.QUIZ_ID AND QR.USER_ID = @USER_ID)
				 as numeric(5,2)
			) as nvarchar(5)
		),'') 
		as [Completed_Rate], 
		ISNULL(
			CONVERT(nvarchar(19),
				(SELECT QR.COMPLETED_DATE FROM dbo.M_QUIZ_RESULTS QR WHERE QR.QUIZ_ID = Q.QUIZ_ID AND QR.USER_ID = @USER_ID)
				,121)
		,'') 
		as [Completed_Date],
		ISNULL(CONVERT(nvarchar(19),(SELECT QR.STARTED_DATE FROM dbo.M_QUIZ_RESULTS QR WHERE QR.QUIZ_ID = Q.QUIZ_ID AND QR.USER_ID = @USER_ID),121),'') 
		as [Started_Date],
		ISNULL(
			  (SELECT dbo.[F_PRINT_DATEDIFF](QR.STARTED_DATE,QR.COMPLETED_DATE) FROM dbo.M_QUIZ_RESULTS QR 
					WHERE QR.QUIZ_ID = Q.QUIZ_ID AND QR.USER_ID = @USER_ID)
		,'') as [Time_taken]
	FROM dbo.M_QUIZES Q
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_STATUS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[P_STATSBYUSER].[@USER_ID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[numeric]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_RATE]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[COMPLETED_DATE]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[STARTED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[DBO].[F_PRINT_DATEDIFF]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[dbo].[P_STATSBYUSER].[@USER_ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="1241" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE P_STATSBYUSER&#xD;&#xA;@USER_ID int&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[DBO].[P_STATSBYUSERQUIZ]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	DECLARE @Quiz_Status int = ISNULL((SELECT QUIZ_STATUS FROM [DBO].[M_QUIZ_RESULTS] WHERE QUIZ_ID = @QUIZ_ID AND USER_ID= @USER_ID),0)
	SELECT 
		Q.[INFO], 
		Q.[TEXT],
		CASE WHEN 
				(SELECT QA.ANSWER_FLAG
			FROM DBO.M_QUIZ_RESULTS QR
			JOIN DBO.M_QUIZ_ANSWERS QA ON QA.QUIZ_RESULT_ID = QR.QUIZ_RESULT_ID
			WHERE QR.USER_ID = @USER_ID
			AND QR.QUIZ_ID = Q.QUIZ_ID
			AND QA.QUESTION_ID = Q.QUESTION_ID) IS NULL
			THEN 'NOT ANSWERED'
		WHEN Q.CORRECT_OPTION_FLAG =
		(
			SELECT QA.ANSWER_FLAG
			FROM DBO.M_QUIZ_RESULTS QR
			JOIN DBO.M_QUIZ_ANSWERS QA ON QA.QUIZ_RESULT_ID = QR.QUIZ_RESULT_ID
			WHERE QR.USER_ID = @USER_ID
			AND QR.QUIZ_ID = Q.QUIZ_ID
			AND QA.QUESTION_ID = Q.QUESTION_ID
		)
		THEN 'RIGHT' 
		ELSE 'WRONG' END
			AS RESULT
	 FROM M_QUESTIONS Q
	WHERE Q.QUIZ_ID = @QUIZ_ID
	ORDER BY Q.QUESTION_ID
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_STATUS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[DBO].[P_STATSBYUSERQUIZ].[@QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[DBO].[P_STATSBYUSERQUIZ].[@USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[INFO]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[TEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[ANSWER_FLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[CORRECT_OPTION_FLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[DBO].[P_STATSBYUSERQUIZ].[@USER_ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[DBO].[P_STATSBYUSERQUIZ].[@QUIZ_ID]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="942" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE PROCEDURE [DBO].[P_STATSBYUSERQUIZ]&#xD;&#xA;@USER_ID INT,&#xD;&#xA;@QUIZ_ID int &#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_M_QUESTIONS]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="14" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_M_QUIZ_ANSWERS]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[M_QUIZ_ANSWERS].[QUIZ_ANSWERS_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUIZ_ANSWERS]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="15" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_M_QUIZ_RESULTS]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[M_QUIZ_RESULTS].[QUIZ_RESULT_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUIZ_RESULTS]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="16" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_M_QUIZES]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="17" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_M_USERS]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[M_USERS].[USER_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="19" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_M_VARIANTS]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[M_VARIANTS].[VARIANT_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[M_VARIANTS]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="21" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[S_PK_GENERATOR]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[S_PK_GENERATOR].[TABLE_NAME]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[S_PK_GENERATOR].[TABLE_ID]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="18" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[numeric]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="22" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[T_LOG]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[T_LOG].[Id]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[T_LOG].[Date]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[T_LOG].[Thread]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[T_LOG].[Level]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[T_LOG].[Logger]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="255" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[T_LOG].[Message]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="4000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[T_LOG].[Exception]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2000" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Filegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlView" Name="[dbo].[V_M_QUESTIONS]">
			<Property Name="QueryScript">
				<Value><![CDATA[ 
SELECT [QUESTION_ID]
      ,[QUIZ_ID]
      ,[INFO]
      ,[TEXT]
      ,[CORRECT_OPTION_FLAG]
  FROM [dbo].[M_QUESTIONS]]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_QUESTIONS].[QUESTION_ID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_QUESTIONS].[QUIZ_ID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_QUESTIONS].[INFO]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_QUESTIONS].[INFO]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_QUESTIONS].[TEXT]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_QUESTIONS].[TEXT]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_QUESTIONS].[CORRECT_OPTION_FLAG]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_QUESTIONS].[CORRECT_OPTION_FLAG]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[M_QUESTIONS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUESTION_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[INFO]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[TEXT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUESTIONS].[CORRECT_OPTION_FLAG]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="166" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW [dbo].[V_M_QUESTIONS]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[V_M_QUIZES]">
			<Property Name="QueryScript">
				<Value><![CDATA[
	SELECT 
		[QUIZ_ID]
      ,[QUIZ_NAME]
      ,[AUTHOR_ID]
	  ,(SELECT ISNULL(FIRSTNAME,'') + ' ' + ISNULL(LASTNAME,'') FROM dbo.M_USERS WHERE M_USERS.USER_ID = M_QUIZES.AUTHOR_ID) as AUTHOR
      ,CONVERT(nvarchar(23),[CREATED_DATE],121) as [CREATED_DATE]
      ,[SUCCESS_RATE]
  FROM [dbo].[M_QUIZES]]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_QUIZES].[QUIZ_ID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_QUIZES].[QUIZ_NAME]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_QUIZES].[AUTHOR_ID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_QUIZES].[AUTHOR_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_QUIZES].[AUTHOR]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_QUIZES].[CREATED_DATE]" />
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_QUIZES].[SUCCESS_RATE]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_QUIZES].[SUCCESS_RATE]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[M_QUIZES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[QUIZ_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[AUTHOR_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[FIRSTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[LASTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[AUTHOR_ID]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[CREATED_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_QUIZES].[SUCCESS_RATE]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="345" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW [dbo].[V_M_QUIZES]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[V_M_ROLES]">
			<Property Name="QueryScript">
				<Value><![CDATA[ SELECT ROLE_ID, ROLE_NAME, ROLE_FLAG, ALLOWED_METHODS FROM dbo.[M_ROLES]]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_ROLES].[ROLE_ID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_ROLES].[ROLE_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_ROLES].[ROLE_NAME]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_ROLES].[ROLE_NAME]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_ROLES].[ROLE_FLAG]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_ROLES].[ROLE_FLAG]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_ROLES].[ALLOWED_METHODS]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_ROLES].[ALLOWED_METHODS]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[M_ROLES]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_ROLES].[ROLE_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_ROLES].[ROLE_NAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_ROLES].[ROLE_FLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_ROLES].[ALLOWED_METHODS]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="107" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW [dbo].[V_M_ROLES]&#xD;&#xA;&#x9;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlView" Name="[dbo].[V_M_USERS]">
			<Property Name="QueryScript">
				<Value><![CDATA[
SELECT [USER_ID], [FIRSTNAME], [LASTNAME], [USERNAME], [HASHEDPASSWORD], [SALT], [ROLESFLAG], [REGISTRATION_DATE], [LAST_LOGON_DATE]
FROM  dbo.M_USERS]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_USERS].[USER_ID]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_USERS].[USER_ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_USERS].[FIRSTNAME]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_USERS].[FIRSTNAME]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_USERS].[LASTNAME]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_USERS].[LASTNAME]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_USERS].[USERNAME]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_USERS].[USERNAME]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_USERS].[HASHEDPASSWORD]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_USERS].[HASHEDPASSWORD]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_USERS].[SALT]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_USERS].[SALT]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_USERS].[ROLESFLAG]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_USERS].[ROLESFLAG]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_USERS].[REGISTRATION_DATE]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_USERS].[REGISTRATION_DATE]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlComputedColumn" Name="[dbo].[V_M_USERS].[LAST_LOGON_DATE]">
						<Relationship Name="ExpressionDependencies">
							<Entry>
								<References Name="[dbo].[M_USERS].[LAST_LOGON_DATE]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="QueryDependencies">
				<Entry>
					<References Name="[dbo].[M_USERS]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USER_ID]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[FIRSTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[LASTNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[USERNAME]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[HASHEDPASSWORD]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[SALT]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[ROLESFLAG]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[REGISTRATION_DATE]" />
				</Entry>
				<Entry>
					<References Name="[dbo].[M_USERS].[LAST_LOGON_DATE]" />
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="Length" Value="186" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="CREATE VIEW [dbo].[V_M_USERS]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[XPK_S_PK_GENERATOR]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[S_PK_GENERATOR].[TABLE_NAME]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[S_PK_GENERATOR]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="22" />
		</Element>
	</Model>
</DataSchemaModel>